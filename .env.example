# --- Core ---
APP_ENV=dev
HOST=127.0.0.1
PORT=8000
LOG_LEVEL=info

# --- Database (PostgreSQL) ---
# Önerilen (async):
DATABASE_URL=postgresql+asyncpg://secmon:secmon@127.0.0.1:5432/secmon
# Alternatif (sync):
# DATABASE_URL=postgresql://secmon:secmon@127.0.0.1:5432/secmon

# --- Privacy / Hash ---
# IP hash için salt (uzun ve rastgele seçin)
IP_SALT=change_me_long_random

# --- Alerts ---
ALERT_SINKS=stdout,file
ALERT_FILE_PATH=./alerts.log
ALERT_WEBHOOK_URLS=
ALERT_DEDUP_WINDOW_SEC=300
ALERT_COOLDOWN_GLOBAL_SEC=1
ALERT_RETRY_MAX=3
ALERT_RETRY_BACKOFF_MS=250

# --- Quarantine (fail2ban-lite) ---
QUARANTINE_ENABLED=true
QUARANTINE_BAN_SECONDS=300
QUARANTINE_BLOCK_STATUS=403
# Z-score gereksinimi (yalnızca anomali tespitinde banla): true/false
QUARANTINE_REQUIRE_Z=false
# Geliştirici logları
QUARANTINE_DEBUG=0
# Karantinadan muaf yollar (virgül ile ayır)
QUARANTINE_EXCLUDE_PATHS="/metrics,/_debug/config"
# Manuel allowlist (virgül ile IP/Hash)
ALLOWLIST_IPS=

# --- Rate window (ban tetikleyici) ---
# RATE_WINDOW_SECONDS içinde RATE_THRESHOLD istek => ban
RATE_WINDOW_SECONDS=1
RATE_THRESHOLD=20

# --- Trusted proxy / XFF ---
TRUSTED_PROXY_CIDRS=127.0.0.1/32,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16

# --- Retention ---
RETENTION_DAYS=30

# --- Z-Score Anomaly ---
# Oransal/sıra dışı pikleri yakalamak için
ZSCORE_ENABLED=true
ZSCORE_BUCKET_SEC=2
ZSCORE_WINDOW_MIN=15
ZSCORE_MIN_SAMPLES=5
ZSCORE_THRESHOLD=2.0