# --- Core ---
APP_ENV=dev
HOST=127.0.0.1
PORT=8000
LOG_LEVEL=info
# --- Runtime env ---
ENV=dev

# --- Database (PostgreSQL) ---
# Önerilen (async):
DATABASE_URL=postgresql+asyncpg://secmon:secmon@127.0.0.1:5432/secmon
# Alternatif (sync):
# DATABASE_URL=postgresql://secmon:secmon@127.0.0.1:5432/secmon

# --- Privacy / Hash ---
# IP hash için salt (uzun ve rastgele seçin)
IP_SALT=change_me_in_prod

# --- Alerts ---
# Monitor/Quarantine kaynaklı uyarılar için basit ayarlar
ALERT_COOLDOWN_SECONDS=60
ALERT_KEEP_RECENT=200
# Optional sinks (varsa ilgili sink sınıfları yüklü olmalı)
# ALERT_FILE_PATH=./alerts.log
# ALERT_WEBHOOK_URL=https://example.com/alert-hook

# --- Quarantine (fail2ban-lite) ---
QUARANTINE_ENABLED=false
QUARANTINE_BAN_SECONDS=600
QUARANTINE_BLOCK_STATUS=403
# Z-score gereksinimi (yalnızca anomali tespitinde banla): true/false
QUARANTINE_REQUIRE_Z=false
# Geliştirici logları
QUARANTINE_DEBUG=0
# Karantinadan muaf yollar (virgül ile ayır)
QUARANTINE_EXCLUDE_PATHS=/metrics,/favicon.ico
# Manuel allowlist (virgül ile IP/Hash)
ALLOWLIST_IPS=

# --- Rate window (ban tetikleyici) ---
# RATE_WINDOW_SECONDS içinde RATE_THRESHOLD istek => ban
RATE_WINDOW_SECONDS=1
RATE_THRESHOLD=20

# --- Trusted proxy / XFF ---
TRUSTED_PROXY_CIDRS=127.0.0.1/32

# --- Retention ---
RETENTION_DAYS=30

# --- Z-Score Anomaly ---
# Oransal/sıra dışı pikleri yakalamak için
ZSCORE_ENABLED=true
ZSCORE_BUCKET_SEC=1
ZSCORE_WINDOW_MIN=10
ZSCORE_MIN_SAMPLES=5
ZSCORE_THRESHOLD=3.0

# --- Observability demo vars (optional) ---
# BASE_URL=http://127.0.0.1:8000
# IP=198.51.100.23